<?php

global $post;
?>

<?php if ( is_single() && $post->post_type == 'post' ):?>
<nav class="bx--grid bx--breadcrumb bx--breadcrumb--no-trailing-slash post" aria-label="breadcrumb">
<?php else: ?>
<nav class="bx--grid bx--breadcrumb bx--breadcrumb--no-trailing-slash" aria-label="breadcrumb">
<?php endif; ?>

<?php if (!is_home()) :?>
    <div class="bx--breadcrumb-item">
      <a href="<?php echo get_home_url(); ?>" class="bx--link">
        <?php
          $frontpage_id = get_option( 'page_on_front' );
          echo get_the_title($frontpage_id);
        ?>
      </a>
    </div>

          <?php if ( is_single() ):

                  $title = get_the_title();

                      if ( $post->post_type == 'consultants' ): ?>

                          <div class="bx--breadcrumb-item">
                            <a href="<?php echo get_home_url() . '/konsulter' ?>" class="bx--link">
                              Konsulter
                            </a>
                          </div>

                          <div class="bx--breadcrumb-item">
                            <a class="bx--link_current">
                              <?php if ( strlen($title) > 40 ):

                                      echo substr($title, 0, 40).'...';

                                    else:

                                      echo $title;

                                    endif;
                              ?>
                            </a>
                          </div>
                          <?php
                      elseif ( $post->post_type == 'services' ): ?>

                          <div class="bx--breadcrumb-item">
                            <a href="<?php echo get_home_url() . '/tjanster' ?>" class="bx--link">
                              Tj√§nster
                            </a>
                          </div>

                          <div class="bx--breadcrumb-item">
                            <a class="bx--link_current">
                              <?php if ( strlen($title) > 40 ):

                                      echo substr($title, 0, 40).'...';

                                    else:

                                      echo $title;

                                    endif;
                              ?>
                            </a>
                          </div>

                          <?php
                      elseif ( $post->post_type == 'post' ): ?>

                              <div class="bx--breadcrumb-item">
                                <a href="<?php echo get_home_url() . '/resurser' ?>" class="bx--link">
                                  Resurser
                                </a>
                              </div>

                              <div class="bx--breadcrumb-item">
                                <a class="bx--link_current">
                                  <?php if ( strlen($title) > 40 ):

                                          echo substr($title, 0, 40).'...';

                                        else:

                                          echo $title;

                                        endif;
                                  ?>
                                </a>
                              </div>
                              <?php
                      endif;



                 elseif ( is_page() ):

                   if($post->post_parent):
                       $anc = get_post_ancestors( $post->ID );
                       $title = get_the_title();

                       foreach ( $anc as $ancestor ) {
                           $output = ' <div class="bx--breadcrumb-item"><a class="bx--link" href="'.get_permalink($ancestor).'">'.get_the_title($ancestor).'</a></div>';
                       }

                       echo $output;

                         if ( !is_page($frontpage_id) ):?>

                         <div class="bx--breadcrumb-item">
                           <a class="bx--link_current"><?= $title?></a>
                         </div>

                     <?php endif;

                else:

                        if ( !is_page($frontpage_id) ):?>

                        <div class="bx--breadcrumb-item">
                          <a class="bx--link_current"><?= get_the_title();?></a>
                        </div>
                    <?php endif;

                endif;

        endif;

  endif;
?>

</nav>
